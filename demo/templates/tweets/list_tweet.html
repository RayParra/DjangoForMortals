{% extends "base.html" %}

{% block title %}ListTweet{% endblock %}

{% block script %}
	<script type="text/javascript">
		$(document).ready(function(){
			console.log("Working");
		});

		$.ajax({
			url: "{% url 'tweet-api:TweetListAPIView_api' %}",
			method: "GET",
			success: function(data){
				//console.log(data)
				$.each(data, function(key, value){
					console.log(key)
					console.log(value.user)
					console.log(value.content)
					var tweetKey = key
					var tweetUser = value.user
					var tweetContent = value.content
					var tweetTimestamp = value.timestamp

					$("#tweet-container").append(
			
						"<div class=\"media\"> <img class=\"mr-3\" src=\".../64x64\" alt=\"UserImage\"><div class=\"media-body\"> <h5 class=\"mt-0\">" + tweetUser.username + " <br></h5>" + tweetContent + "<small> Publicated: tweetTimestamp ago | <a href=\"#\">view</a><br></small> </div> </div> <hr>"

						)
				})
			},
			error: function(data){
				console.log("error")
				console.log(data)
			}
		})
	</script>
{% endblock %}

{% block content %}


		<div class="row">	

		<div class="col-sm-9">

			{% if not request.GET.p %}
				<div class="">
					{% include "tweets/form_create.html" with form=create_form action_url=create_url btn_title="Tweet" %}	
				</div>
			{% endif %}
		<hr>

<div id="tweet-container">
	
</div>

			{% for t in object_list %}
				
			<div class="media">
			  <img class="mr-3" src=".../64x64" alt="UserImage">
			  <div class="media-body">
			    <h5 class="mt-0">{{ t.user }} <br></h5>
			    {{ t.content }}
			    <small>
			    	Publicated: {{ t.timestamp }} ago | <a href="{% url 'tweets:Detail_Tweet_view' t.id %}">view</a><br>
			    </small>	
			  </div>
			</div>
		<hr>
			{% empty %}
				{% if request.GET.q %}
					No Tweet Found
				{% else %}
					No Tweet yet!
				{% endif %}
			{% endfor %}
		</div>
		</div>
{% endblock %}

